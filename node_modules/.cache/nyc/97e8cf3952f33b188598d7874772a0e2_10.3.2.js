var cov_rlwj31ydm=function(){var path='/home/andrews/naivecoin/lib/httpServer/index.js',hash='a17844cab98a9b6436641a566596cb6d8bb470f6',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/home/andrews/naivecoin/lib/httpServer/index.js',statementMap:{'0':{start:{line:1,column:16},end:{line:1,column:34}},'1':{start:{line:2,column:19},end:{line:2,column:41}},'2':{start:{line:3,column:18},end:{line:3,column:47}},'3':{start:{line:4,column:10},end:{line:4,column:26}},'4':{start:{line:5,column:24},end:{line:5,column:49}},'5':{start:{line:6,column:14},end:{line:6,column:44}},'6':{start:{line:7,column:20},end:{line:7,column:56}},'7':{start:{line:8,column:34},end:{line:8,column:84}},'8':{start:{line:9,column:28},end:{line:9,column:72}},'9':{start:{line:10,column:18},end:{line:10,column:40}},'10':{start:{line:11,column:22},end:{line:11,column:54}},'11':{start:{line:12,column:19},end:{line:12,column:48}},'12':{start:{line:16,column:8},end:{line:16,column:29}},'13':{start:{line:18,column:30},end:{line:25,column:9}},'14':{start:{line:19,column:12},end:{line:24,column:14}},'15':{start:{line:22,column:20},end:{line:22,column:45}},'16':{start:{line:27,column:8},end:{line:27,column:40}},'17':{start:{line:29,column:8},end:{line:29,column:85}},'18':{start:{line:31,column:8},end:{line:33,column:11}},'19':{start:{line:32,column:12},end:{line:32,column:60}},'20':{start:{line:35,column:8},end:{line:40,column:11}},'21':{start:{line:36,column:28},end:{line:36,column:53}},'22':{start:{line:37,column:12},end:{line:37,column:84}},'23':{start:{line:37,column:35},end:{line:37,column:84}},'24':{start:{line:39,column:12},end:{line:39,column:44}},'25':{start:{line:42,column:8},end:{line:49,column:11}},'26':{start:{line:43,column:31},end:{line:43,column:55}},'27':{start:{line:44,column:25},end:{line:44,column:62}},'28':{start:{line:46,column:12},end:{line:48,column:67}},'29':{start:{line:46,column:32},end:{line:46,column:92}},'30':{start:{line:47,column:17},end:{line:48,column:67}},'31':{start:{line:47,column:29},end:{line:47,column:64}},'32':{start:{line:48,column:17},end:{line:48,column:67}},'33':{start:{line:51,column:8},end:{line:56,column:11}},'34':{start:{line:52,column:29},end:{line:52,column:71}},'35':{start:{line:53,column:12},end:{line:53,column:111}},'36':{start:{line:53,column:36},end:{line:53,column:111}},'37':{start:{line:55,column:12},end:{line:55,column:45}},'38':{start:{line:58,column:8},end:{line:63,column:11}},'39':{start:{line:59,column:29},end:{line:59,column:73}},'40':{start:{line:60,column:12},end:{line:60,column:113}},'41':{start:{line:60,column:36},end:{line:60,column:113}},'42':{start:{line:62,column:12},end:{line:62,column:45}},'43':{start:{line:65,column:8},end:{line:70,column:11}},'44':{start:{line:66,column:39},end:{line:66,column:100}},'45':{start:{line:67,column:12},end:{line:67,column:139}},'46':{start:{line:67,column:46},end:{line:67,column:139}},'47':{start:{line:69,column:12},end:{line:69,column:55}},'48':{start:{line:72,column:8},end:{line:74,column:11}},'49':{start:{line:73,column:12},end:{line:73,column:66}},'50':{start:{line:76,column:8},end:{line:89,column:11}},'51':{start:{line:77,column:37},end:{line:77,column:67}},'52':{start:{line:78,column:35},end:{line:78,column:87}},'53':{start:{line:80,column:12},end:{line:80,column:124}},'54':{start:{line:80,column:42},end:{line:80,column:124}},'55':{start:{line:82,column:12},end:{line:88,column:13}},'56':{start:{line:83,column:37},end:{line:83,column:82}},'57':{start:{line:84,column:16},end:{line:84,column:53}},'58':{start:{line:86,column:16},end:{line:87,column:30}},'59':{start:{line:86,column:61},end:{line:86,column:122}},'60':{start:{line:87,column:21},end:{line:87,column:30}},'61':{start:{line:91,column:8},end:{line:93,column:11}},'62':{start:{line:92,column:12},end:{line:92,column:97}},'63':{start:{line:95,column:8},end:{line:101,column:11}},'64':{start:{line:96,column:26},end:{line:96,column:47}},'65':{start:{line:98,column:35},end:{line:98,column:64}},'66':{start:{line:100,column:12},end:{line:100,column:51}},'67':{start:{line:103,column:8},end:{line:112,column:11}},'68':{start:{line:104,column:27},end:{line:104,column:44}},'69':{start:{line:107,column:28},end:{line:107,column:71}},'70':{start:{line:109,column:34},end:{line:109,column:58}},'71':{start:{line:111,column:12},end:{line:111,column:50}},'72':{start:{line:114,column:8},end:{line:121,column:11}},'73':{start:{line:115,column:30},end:{line:115,column:73}},'74':{start:{line:116,column:12},end:{line:116,column:115}},'75':{start:{line:116,column:37},end:{line:116,column:115}},'76':{start:{line:118,column:34},end:{line:118,column:60}},'77':{start:{line:120,column:12},end:{line:120,column:50}},'78':{start:{line:123,column:8},end:{line:143,column:11}},'79':{start:{line:124,column:27},end:{line:124,column:46}},'80':{start:{line:125,column:27},end:{line:125,column:47}},'81':{start:{line:127,column:12},end:{line:127,column:93}},'82':{start:{line:127,column:34},end:{line:127,column:93}},'83':{start:{line:128,column:31},end:{line:128,column:56}},'84':{start:{line:130,column:12},end:{line:142,column:13}},'85':{start:{line:131,column:16},end:{line:131,column:145}},'86':{start:{line:131,column:75},end:{line:131,column:145}},'87':{start:{line:133,column:37},end:{line:133,column:156}},'88':{start:{line:135,column:16},end:{line:135,column:39}},'89':{start:{line:137,column:41},end:{line:137,column:104}},'90':{start:{line:138,column:16},end:{line:138,column:57}},'91':{start:{line:140,column:16},end:{line:141,column:30}},'92':{start:{line:140,column:92},end:{line:140,column:143}},'93':{start:{line:141,column:21},end:{line:141,column:30}},'94':{start:{line:145,column:8},end:{line:154,column:11}},'95':{start:{line:146,column:27},end:{line:146,column:46}},'96':{start:{line:147,column:12},end:{line:153,column:13}},'97':{start:{line:148,column:32},end:{line:148,column:72}},'98':{start:{line:149,column:16},end:{line:149,column:48}},'99':{start:{line:151,column:16},end:{line:152,column:30}},'100':{start:{line:151,column:49},end:{line:151,column:100}},'101':{start:{line:152,column:21},end:{line:152,column:30}},'102':{start:{line:156,column:8},end:{line:172,column:11}},'103':{start:{line:157,column:27},end:{line:157,column:46}},'104':{start:{line:158,column:27},end:{line:158,column:47}},'105':{start:{line:160,column:12},end:{line:160,column:93}},'106':{start:{line:160,column:34},end:{line:160,column:93}},'107':{start:{line:161,column:31},end:{line:161,column:56}},'108':{start:{line:163,column:12},end:{line:171,column:13}},'109':{start:{line:164,column:16},end:{line:164,column:145}},'110':{start:{line:164,column:75},end:{line:164,column:145}},'111':{start:{line:166,column:33},end:{line:166,column:76}},'112':{start:{line:167,column:16},end:{line:167,column:62}},'113':{start:{line:169,column:16},end:{line:170,column:30}},'114':{start:{line:169,column:49},end:{line:169,column:100}},'115':{start:{line:170,column:21},end:{line:170,column:30}},'116':{start:{line:174,column:8},end:{line:185,column:11}},'117':{start:{line:175,column:27},end:{line:175,column:46}},'118':{start:{line:176,column:28},end:{line:176,column:48}},'119':{start:{line:178,column:12},end:{line:184,column:13}},'120':{start:{line:179,column:30},end:{line:179,column:86}},'121':{start:{line:180,column:16},end:{line:180,column:59}},'122':{start:{line:182,column:16},end:{line:183,column:30}},'123':{start:{line:182,column:49},end:{line:182,column:115}},'124':{start:{line:183,column:21},end:{line:183,column:30}},'125':{start:{line:187,column:8},end:{line:189,column:11}},'126':{start:{line:188,column:12},end:{line:188,column:45}},'127':{start:{line:191,column:8},end:{line:194,column:11}},'128':{start:{line:192,column:26},end:{line:192,column:54}},'129':{start:{line:193,column:12},end:{line:193,column:42}},'130':{start:{line:196,column:8},end:{line:201,column:11}},'131':{start:{line:197,column:12},end:{line:200,column:19}},'132':{start:{line:199,column:20},end:{line:199,column:75}},'133':{start:{line:203,column:8},end:{line:214,column:11}},'134':{start:{line:204,column:12},end:{line:213,column:19}},'135':{start:{line:206,column:20},end:{line:206,column:56}},'136':{start:{line:207,column:20},end:{line:207,column:50}},'137':{start:{line:208,column:20},end:{line:208,column:51}},'138':{start:{line:211,column:20},end:{line:212,column:34}},'139':{start:{line:211,column:99},end:{line:211,column:192}},'140':{start:{line:212,column:25},end:{line:212,column:34}},'141':{start:{line:216,column:8},end:{line:220,column:11}},'142':{start:{line:217,column:12},end:{line:218,column:33}},'143':{start:{line:217,column:42},end:{line:217,column:65}},'144':{start:{line:218,column:17},end:{line:218,column:33}},'145':{start:{line:219,column:12},end:{line:219,column:81}},'146':{start:{line:224,column:8},end:{line:230,column:11}},'147':{start:{line:225,column:12},end:{line:229,column:15}},'148':{start:{line:226,column:16},end:{line:226,column:37}},'149':{start:{line:226,column:25},end:{line:226,column:37}},'150':{start:{line:227,column:16},end:{line:227,column:180}},'151':{start:{line:228,column:16},end:{line:228,column:30}},'152':{start:{line:234,column:0},end:{line:234,column:28}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:15,column:4},end:{line:15,column:5}},loc:{start:{line:15,column:51},end:{line:221,column:5}},line:15},'1':{name:'(anonymous_1)',decl:{start:{line:18,column:30},end:{line:18,column:31}},loc:{start:{line:18,column:42},end:{line:25,column:9}},line:18},'2':{name:'(anonymous_2)',decl:{start:{line:21,column:33},end:{line:21,column:34}},loc:{start:{line:21,column:46},end:{line:23,column:17}},line:21},'3':{name:'(anonymous_3)',decl:{start:{line:31,column:43},end:{line:31,column:44}},loc:{start:{line:31,column:57},end:{line:33,column:9}},line:31},'4':{name:'(anonymous_4)',decl:{start:{line:35,column:50},end:{line:35,column:51}},loc:{start:{line:35,column:64},end:{line:40,column:9}},line:35},'5':{name:'(anonymous_5)',decl:{start:{line:42,column:50},end:{line:42,column:51}},loc:{start:{line:42,column:64},end:{line:49,column:9}},line:42},'6':{name:'(anonymous_6)',decl:{start:{line:51,column:66},end:{line:51,column:67}},loc:{start:{line:51,column:80},end:{line:56,column:9}},line:51},'7':{name:'(anonymous_7)',decl:{start:{line:58,column:50},end:{line:58,column:51}},loc:{start:{line:58,column:64},end:{line:63,column:9}},line:58},'8':{name:'(anonymous_8)',decl:{start:{line:65,column:88},end:{line:65,column:89}},loc:{start:{line:65,column:102},end:{line:70,column:9}},line:65},'9':{name:'(anonymous_9)',decl:{start:{line:72,column:49},end:{line:72,column:50}},loc:{start:{line:72,column:63},end:{line:74,column:9}},line:72},'10':{name:'(anonymous_10)',decl:{start:{line:76,column:50},end:{line:76,column:51}},loc:{start:{line:76,column:64},end:{line:89,column:9}},line:76},'11':{name:'(anonymous_11)',decl:{start:{line:91,column:57},end:{line:91,column:58}},loc:{start:{line:91,column:71},end:{line:93,column:9}},line:91},'12':{name:'(anonymous_12)',decl:{start:{line:95,column:42},end:{line:95,column:43}},loc:{start:{line:95,column:56},end:{line:101,column:9}},line:95},'13':{name:'(anonymous_13)',decl:{start:{line:103,column:43},end:{line:103,column:44}},loc:{start:{line:103,column:57},end:{line:112,column:9}},line:103},'14':{name:'(anonymous_14)',decl:{start:{line:114,column:52},end:{line:114,column:53}},loc:{start:{line:114,column:66},end:{line:121,column:9}},line:114},'15':{name:'(anonymous_15)',decl:{start:{line:123,column:66},end:{line:123,column:67}},loc:{start:{line:123,column:80},end:{line:143,column:9}},line:123},'16':{name:'(anonymous_16)',decl:{start:{line:145,column:62},end:{line:145,column:63}},loc:{start:{line:145,column:76},end:{line:154,column:9}},line:145},'17':{name:'(anonymous_17)',decl:{start:{line:156,column:63},end:{line:156,column:64}},loc:{start:{line:156,column:77},end:{line:172,column:9}},line:156},'18':{name:'(anonymous_18)',decl:{start:{line:174,column:81},end:{line:174,column:82}},loc:{start:{line:174,column:95},end:{line:185,column:9}},line:174},'19':{name:'(anonymous_19)',decl:{start:{line:187,column:36},end:{line:187,column:37}},loc:{start:{line:187,column:50},end:{line:189,column:9}},line:187},'20':{name:'(anonymous_20)',decl:{start:{line:191,column:37},end:{line:191,column:38}},loc:{start:{line:191,column:51},end:{line:194,column:9}},line:191},'21':{name:'(anonymous_21)',decl:{start:{line:196,column:89},end:{line:196,column:90}},loc:{start:{line:196,column:103},end:{line:201,column:9}},line:196},'22':{name:'(anonymous_22)',decl:{start:{line:198,column:22},end:{line:198,column:23}},loc:{start:{line:198,column:41},end:{line:200,column:17}},line:198},'23':{name:'(anonymous_23)',decl:{start:{line:203,column:37},end:{line:203,column:38}},loc:{start:{line:203,column:57},end:{line:214,column:9}},line:203},'24':{name:'(anonymous_24)',decl:{start:{line:205,column:22},end:{line:205,column:23}},loc:{start:{line:205,column:36},end:{line:209,column:17}},line:205},'25':{name:'(anonymous_25)',decl:{start:{line:210,column:23},end:{line:210,column:24}},loc:{start:{line:210,column:31},end:{line:213,column:17}},line:210},'26':{name:'(anonymous_26)',decl:{start:{line:216,column:21},end:{line:216,column:22}},loc:{start:{line:216,column:52},end:{line:220,column:9}},line:216},'27':{name:'(anonymous_27)',decl:{start:{line:223,column:4},end:{line:223,column:5}},loc:{start:{line:223,column:23},end:{line:231,column:5}},line:223},'28':{name:'(anonymous_28)',decl:{start:{line:224,column:27},end:{line:224,column:28}},loc:{start:{line:224,column:48},end:{line:230,column:9}},line:224},'29':{name:'(anonymous_29)',decl:{start:{line:225,column:54},end:{line:225,column:55}},loc:{start:{line:225,column:63},end:{line:229,column:13}},line:225}},branchMap:{'0':{loc:{start:{line:37,column:12},end:{line:37,column:84}},type:'if',locations:[{start:{line:37,column:12},end:{line:37,column:84}},{start:{line:37,column:12},end:{line:37,column:84}}],line:37},'1':{loc:{start:{line:46,column:12},end:{line:48,column:67}},type:'if',locations:[{start:{line:46,column:12},end:{line:48,column:67}},{start:{line:46,column:12},end:{line:48,column:67}}],line:46},'2':{loc:{start:{line:47,column:17},end:{line:48,column:67}},type:'if',locations:[{start:{line:47,column:17},end:{line:48,column:67}},{start:{line:47,column:17},end:{line:48,column:67}}],line:47},'3':{loc:{start:{line:53,column:12},end:{line:53,column:111}},type:'if',locations:[{start:{line:53,column:12},end:{line:53,column:111}},{start:{line:53,column:12},end:{line:53,column:111}}],line:53},'4':{loc:{start:{line:60,column:12},end:{line:60,column:113}},type:'if',locations:[{start:{line:60,column:12},end:{line:60,column:113}},{start:{line:60,column:12},end:{line:60,column:113}}],line:60},'5':{loc:{start:{line:67,column:12},end:{line:67,column:139}},type:'if',locations:[{start:{line:67,column:12},end:{line:67,column:139}},{start:{line:67,column:12},end:{line:67,column:139}}],line:67},'6':{loc:{start:{line:80,column:12},end:{line:80,column:124}},type:'if',locations:[{start:{line:80,column:12},end:{line:80,column:124}},{start:{line:80,column:12},end:{line:80,column:124}}],line:80},'7':{loc:{start:{line:86,column:16},end:{line:87,column:30}},type:'if',locations:[{start:{line:86,column:16},end:{line:87,column:30}},{start:{line:86,column:16},end:{line:87,column:30}}],line:86},'8':{loc:{start:{line:116,column:12},end:{line:116,column:115}},type:'if',locations:[{start:{line:116,column:12},end:{line:116,column:115}},{start:{line:116,column:12},end:{line:116,column:115}}],line:116},'9':{loc:{start:{line:127,column:12},end:{line:127,column:93}},type:'if',locations:[{start:{line:127,column:12},end:{line:127,column:93}},{start:{line:127,column:12},end:{line:127,column:93}}],line:127},'10':{loc:{start:{line:131,column:16},end:{line:131,column:145}},type:'if',locations:[{start:{line:131,column:16},end:{line:131,column:145}},{start:{line:131,column:16},end:{line:131,column:145}}],line:131},'11':{loc:{start:{line:140,column:16},end:{line:141,column:30}},type:'if',locations:[{start:{line:140,column:16},end:{line:141,column:30}},{start:{line:140,column:16},end:{line:141,column:30}}],line:140},'12':{loc:{start:{line:140,column:20},end:{line:140,column:90}},type:'binary-expr',locations:[{start:{line:140,column:20},end:{line:140,column:47}},{start:{line:140,column:51},end:{line:140,column:90}}],line:140},'13':{loc:{start:{line:151,column:16},end:{line:152,column:30}},type:'if',locations:[{start:{line:151,column:16},end:{line:152,column:30}},{start:{line:151,column:16},end:{line:152,column:30}}],line:151},'14':{loc:{start:{line:160,column:12},end:{line:160,column:93}},type:'if',locations:[{start:{line:160,column:12},end:{line:160,column:93}},{start:{line:160,column:12},end:{line:160,column:93}}],line:160},'15':{loc:{start:{line:164,column:16},end:{line:164,column:145}},type:'if',locations:[{start:{line:164,column:16},end:{line:164,column:145}},{start:{line:164,column:16},end:{line:164,column:145}}],line:164},'16':{loc:{start:{line:169,column:16},end:{line:170,column:30}},type:'if',locations:[{start:{line:169,column:16},end:{line:170,column:30}},{start:{line:169,column:16},end:{line:170,column:30}}],line:169},'17':{loc:{start:{line:182,column:16},end:{line:183,column:30}},type:'if',locations:[{start:{line:182,column:16},end:{line:183,column:30}},{start:{line:182,column:16},end:{line:183,column:30}}],line:182},'18':{loc:{start:{line:211,column:20},end:{line:212,column:34}},type:'if',locations:[{start:{line:211,column:20},end:{line:212,column:34}},{start:{line:211,column:20},end:{line:212,column:34}}],line:211},'19':{loc:{start:{line:211,column:24},end:{line:211,column:97}},type:'binary-expr',locations:[{start:{line:211,column:24},end:{line:211,column:57}},{start:{line:211,column:61},end:{line:211,column:97}}],line:211},'20':{loc:{start:{line:217,column:12},end:{line:218,column:33}},type:'if',locations:[{start:{line:217,column:12},end:{line:218,column:33}},{start:{line:217,column:12},end:{line:218,column:33}}],line:217},'21':{loc:{start:{line:219,column:36},end:{line:219,column:78}},type:'cond-expr',locations:[{start:{line:219,column:48},end:{line:219,column:73}},{start:{line:219,column:76},end:{line:219,column:78}}],line:219},'22':{loc:{start:{line:226,column:16},end:{line:226,column:37}},type:'if',locations:[{start:{line:226,column:16},end:{line:226,column:37}},{start:{line:226,column:16},end:{line:226,column:37}}],line:226}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0,'84':0,'85':0,'86':0,'87':0,'88':0,'89':0,'90':0,'91':0,'92':0,'93':0,'94':0,'95':0,'96':0,'97':0,'98':0,'99':0,'100':0,'101':0,'102':0,'103':0,'104':0,'105':0,'106':0,'107':0,'108':0,'109':0,'110':0,'111':0,'112':0,'113':0,'114':0,'115':0,'116':0,'117':0,'118':0,'119':0,'120':0,'121':0,'122':0,'123':0,'124':0,'125':0,'126':0,'127':0,'128':0,'129':0,'130':0,'131':0,'132':0,'133':0,'134':0,'135':0,'136':0,'137':0,'138':0,'139':0,'140':0,'141':0,'142':0,'143':0,'144':0,'145':0,'146':0,'147':0,'148':0,'149':0,'150':0,'151':0,'152':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0],'10':[0,0],'11':[0,0],'12':[0,0],'13':[0,0],'14':[0,0],'15':[0,0],'16':[0,0],'17':[0,0],'18':[0,0],'19':[0,0],'20':[0,0],'21':[0,0],'22':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const express=(++cov_rlwj31ydm.s[0],require('express'));const bodyParser=(++cov_rlwj31ydm.s[1],require('body-parser'));const swaggerUi=(++cov_rlwj31ydm.s[2],require('swagger-ui-express'));const R=(++cov_rlwj31ydm.s[3],require('ramda'));const swaggerDocument=(++cov_rlwj31ydm.s[4],require('./swagger.json'));const Block=(++cov_rlwj31ydm.s[5],require('../blockchain/block'));const Transaction=(++cov_rlwj31ydm.s[6],require('../blockchain/transaction'));const TransactionAssertionError=(++cov_rlwj31ydm.s[7],require('../blockchain/transactionAssertionError'));const BlockAssertionError=(++cov_rlwj31ydm.s[8],require('../blockchain/blockAssertionError'));const HTTPError=(++cov_rlwj31ydm.s[9],require('./httpError'));const ArgumentError=(++cov_rlwj31ydm.s[10],require('../util/argumentError'));const CryptoUtil=(++cov_rlwj31ydm.s[11],require('../util/cryptoUtil'));class HttpServer{constructor(node,blockchain,operator,miner){++cov_rlwj31ydm.f[0];++cov_rlwj31ydm.s[12];this.app=express();++cov_rlwj31ydm.s[13];const projectWallet=wallet=>{++cov_rlwj31ydm.f[1];++cov_rlwj31ydm.s[14];return{id:wallet.id,addresses:R.map(keyPair=>{++cov_rlwj31ydm.f[2];++cov_rlwj31ydm.s[15];return keyPair.publicKey;},wallet.keyPairs)};};++cov_rlwj31ydm.s[16];this.app.use(bodyParser.json());++cov_rlwj31ydm.s[17];this.app.use('/api-docs',swaggerUi.serve,swaggerUi.setup(swaggerDocument));++cov_rlwj31ydm.s[18];this.app.get('/blockchain/blocks',(req,res)=>{++cov_rlwj31ydm.f[3];++cov_rlwj31ydm.s[19];res.status(200).send(blockchain.getAllBlocks());});++cov_rlwj31ydm.s[20];this.app.get('/blockchain/blocks/latest',(req,res)=>{++cov_rlwj31ydm.f[4];let lastBlock=(++cov_rlwj31ydm.s[21],blockchain.getLastBlock());++cov_rlwj31ydm.s[22];if(lastBlock==null){++cov_rlwj31ydm.b[0][0];++cov_rlwj31ydm.s[23];throw new HTTPError(404,'Last block not found');}else{++cov_rlwj31ydm.b[0][1];}++cov_rlwj31ydm.s[24];res.status(200).send(lastBlock);});++cov_rlwj31ydm.s[25];this.app.put('/blockchain/blocks/latest',(req,res)=>{++cov_rlwj31ydm.f[5];let requestBlock=(++cov_rlwj31ydm.s[26],Block.fromJson(req.body));let result=(++cov_rlwj31ydm.s[27],node.checkReceivedBlock(requestBlock));++cov_rlwj31ydm.s[28];if(result==null){++cov_rlwj31ydm.b[1][0];++cov_rlwj31ydm.s[29];res.status(200).send('Requesting the blockchain to check.');}else{++cov_rlwj31ydm.b[1][1];++cov_rlwj31ydm.s[30];if(result){++cov_rlwj31ydm.b[2][0];++cov_rlwj31ydm.s[31];res.status(200).send(requestBlock);}else{++cov_rlwj31ydm.b[2][1];++cov_rlwj31ydm.s[32];throw new HTTPError(409,'Blockchain is update.');}}});++cov_rlwj31ydm.s[33];this.app.get('/blockchain/blocks/:hash([a-zA-Z0-9]{64})',(req,res)=>{++cov_rlwj31ydm.f[6];let blockFound=(++cov_rlwj31ydm.s[34],blockchain.getBlockByHash(req.params.hash));++cov_rlwj31ydm.s[35];if(blockFound==null){++cov_rlwj31ydm.b[3][0];++cov_rlwj31ydm.s[36];throw new HTTPError(404,`Block not found with hash '${req.params.hash}'`);}else{++cov_rlwj31ydm.b[3][1];}++cov_rlwj31ydm.s[37];res.status(200).send(blockFound);});++cov_rlwj31ydm.s[38];this.app.get('/blockchain/blocks/:index',(req,res)=>{++cov_rlwj31ydm.f[7];let blockFound=(++cov_rlwj31ydm.s[39],blockchain.getBlockByIndex(req.params.index));++cov_rlwj31ydm.s[40];if(blockFound==null){++cov_rlwj31ydm.b[4][0];++cov_rlwj31ydm.s[41];throw new HTTPError(404,`Block not found with index '${req.params.index}'`);}else{++cov_rlwj31ydm.b[4][1];}++cov_rlwj31ydm.s[42];res.status(200).send(blockFound);});++cov_rlwj31ydm.s[43];this.app.get('/blockchain/blocks/transactions/:transactionId([a-zA-Z0-9]{64})',(req,res)=>{++cov_rlwj31ydm.f[8];let transactionFromBlock=(++cov_rlwj31ydm.s[44],blockchain.getTransactionFromBlocks(req.params.transactionId));++cov_rlwj31ydm.s[45];if(transactionFromBlock==null){++cov_rlwj31ydm.b[5][0];++cov_rlwj31ydm.s[46];throw new HTTPError(404,`Transaction '${req.params.transactionId}' not found in any block`);}else{++cov_rlwj31ydm.b[5][1];}++cov_rlwj31ydm.s[47];res.status(200).send(transactionFromBlock);});++cov_rlwj31ydm.s[48];this.app.get('/blockchain/transactions',(req,res)=>{++cov_rlwj31ydm.f[9];++cov_rlwj31ydm.s[49];res.status(200).send(blockchain.getAllTransactions());});++cov_rlwj31ydm.s[50];this.app.post('/blockchain/transactions',(req,res)=>{++cov_rlwj31ydm.f[10];let requestTransaction=(++cov_rlwj31ydm.s[51],Transaction.fromJson(req.body));let transactionFound=(++cov_rlwj31ydm.s[52],blockchain.getTransactionById(requestTransaction.id));++cov_rlwj31ydm.s[53];if(transactionFound!=null){++cov_rlwj31ydm.b[6][0];++cov_rlwj31ydm.s[54];throw new HTTPError(409,`Transaction '${requestTransaction.id}' already exists`);}else{++cov_rlwj31ydm.b[6][1];}++cov_rlwj31ydm.s[55];try{let newTransaction=(++cov_rlwj31ydm.s[56],blockchain.addTransaction(requestTransaction));++cov_rlwj31ydm.s[57];res.status(201).send(newTransaction);}catch(ex){++cov_rlwj31ydm.s[58];if(ex instanceof TransactionAssertionError){++cov_rlwj31ydm.b[7][0];++cov_rlwj31ydm.s[59];throw new HTTPError(400,ex.message,requestTransaction,ex);}else{++cov_rlwj31ydm.b[7][1];++cov_rlwj31ydm.s[60];throw ex;}}});++cov_rlwj31ydm.s[61];this.app.get('/blockchain/transactions/unspent',(req,res)=>{++cov_rlwj31ydm.f[11];++cov_rlwj31ydm.s[62];res.status(200).send(blockchain.getUnspentTransactionsForAddress(req.query.address));});++cov_rlwj31ydm.s[63];this.app.get('/operator/wallets',(req,res)=>{++cov_rlwj31ydm.f[12];let wallets=(++cov_rlwj31ydm.s[64],operator.getWallets());let projectedWallets=(++cov_rlwj31ydm.s[65],R.map(projectWallet,wallets));++cov_rlwj31ydm.s[66];res.status(200).send(projectedWallets);});++cov_rlwj31ydm.s[67];this.app.post('/operator/wallets',(req,res)=>{++cov_rlwj31ydm.f[13];let password=(++cov_rlwj31ydm.s[68],req.body.password);//   if (R.match(/\w+/g, password).length <= 4) throw new HTTPError(400, 'Password must contain more than 4 words');
let newWallet=(++cov_rlwj31ydm.s[69],operator.createWalletFromPassword(password));let projectedWallet=(++cov_rlwj31ydm.s[70],projectWallet(newWallet));++cov_rlwj31ydm.s[71];res.status(201).send(projectedWallet);});++cov_rlwj31ydm.s[72];this.app.get('/operator/wallets/:walletId',(req,res)=>{++cov_rlwj31ydm.f[14];let walletFound=(++cov_rlwj31ydm.s[73],operator.getWalletById(req.params.walletId));++cov_rlwj31ydm.s[74];if(walletFound==null){++cov_rlwj31ydm.b[8][0];++cov_rlwj31ydm.s[75];throw new HTTPError(404,`Wallet not found with id '${req.params.walletId}'`);}else{++cov_rlwj31ydm.b[8][1];}let projectedWallet=(++cov_rlwj31ydm.s[76],projectWallet(walletFound));++cov_rlwj31ydm.s[77];res.status(200).send(projectedWallet);});++cov_rlwj31ydm.s[78];this.app.post('/operator/wallets/:walletId/transactions',(req,res)=>{++cov_rlwj31ydm.f[15];let walletId=(++cov_rlwj31ydm.s[79],req.params.walletId);let password=(++cov_rlwj31ydm.s[80],req.headers.password);++cov_rlwj31ydm.s[81];if(password==null){++cov_rlwj31ydm.b[9][0];++cov_rlwj31ydm.s[82];throw new HTTPError(401,'Wallet\'s password is missing.');}else{++cov_rlwj31ydm.b[9][1];}let passwordHash=(++cov_rlwj31ydm.s[83],CryptoUtil.hash(password));++cov_rlwj31ydm.s[84];try{++cov_rlwj31ydm.s[85];if(!operator.checkWalletPassword(walletId,passwordHash)){++cov_rlwj31ydm.b[10][0];++cov_rlwj31ydm.s[86];throw new HTTPError(403,`Invalid password for wallet '${walletId}'`);}else{++cov_rlwj31ydm.b[10][1];}let newTransaction=(++cov_rlwj31ydm.s[87],operator.createTransaction(walletId,req.body.fromAddress,req.body.toAddress,req.body.amount,req.body.changeAddress));++cov_rlwj31ydm.s[88];newTransaction.check();let transactionCreated=(++cov_rlwj31ydm.s[89],blockchain.addTransaction(Transaction.fromJson(newTransaction)));++cov_rlwj31ydm.s[90];res.status(201).send(transactionCreated);}catch(ex){++cov_rlwj31ydm.s[91];if((++cov_rlwj31ydm.b[12][0],ex instanceof ArgumentError)||(++cov_rlwj31ydm.b[12][1],ex instanceof TransactionAssertionError)){++cov_rlwj31ydm.b[11][0];++cov_rlwj31ydm.s[92];throw new HTTPError(400,ex.message,walletId,ex);}else{++cov_rlwj31ydm.b[11][1];++cov_rlwj31ydm.s[93];throw ex;}}});++cov_rlwj31ydm.s[94];this.app.get('/operator/wallets/:walletId/addresses',(req,res)=>{++cov_rlwj31ydm.f[16];let walletId=(++cov_rlwj31ydm.s[95],req.params.walletId);++cov_rlwj31ydm.s[96];try{let addresses=(++cov_rlwj31ydm.s[97],operator.getAddressesForWallet(walletId));++cov_rlwj31ydm.s[98];res.status(200).send(addresses);}catch(ex){++cov_rlwj31ydm.s[99];if(ex instanceof ArgumentError){++cov_rlwj31ydm.b[13][0];++cov_rlwj31ydm.s[100];throw new HTTPError(400,ex.message,walletId,ex);}else{++cov_rlwj31ydm.b[13][1];++cov_rlwj31ydm.s[101];throw ex;}}});++cov_rlwj31ydm.s[102];this.app.post('/operator/wallets/:walletId/addresses',(req,res)=>{++cov_rlwj31ydm.f[17];let walletId=(++cov_rlwj31ydm.s[103],req.params.walletId);let password=(++cov_rlwj31ydm.s[104],req.headers.password);++cov_rlwj31ydm.s[105];if(password==null){++cov_rlwj31ydm.b[14][0];++cov_rlwj31ydm.s[106];throw new HTTPError(401,'Wallet\'s password is missing.');}else{++cov_rlwj31ydm.b[14][1];}let passwordHash=(++cov_rlwj31ydm.s[107],CryptoUtil.hash(password));++cov_rlwj31ydm.s[108];try{++cov_rlwj31ydm.s[109];if(!operator.checkWalletPassword(walletId,passwordHash)){++cov_rlwj31ydm.b[15][0];++cov_rlwj31ydm.s[110];throw new HTTPError(403,`Invalid password for wallet '${walletId}'`);}else{++cov_rlwj31ydm.b[15][1];}let newAddress=(++cov_rlwj31ydm.s[111],operator.generateAddressForWallet(walletId));++cov_rlwj31ydm.s[112];res.status(201).send({address:newAddress});}catch(ex){++cov_rlwj31ydm.s[113];if(ex instanceof ArgumentError){++cov_rlwj31ydm.b[16][0];++cov_rlwj31ydm.s[114];throw new HTTPError(400,ex.message,walletId,ex);}else{++cov_rlwj31ydm.b[16][1];++cov_rlwj31ydm.s[115];throw ex;}}});++cov_rlwj31ydm.s[116];this.app.get('/operator/wallets/:walletId/addresses/:addressId/balance',(req,res)=>{++cov_rlwj31ydm.f[18];let walletId=(++cov_rlwj31ydm.s[117],req.params.walletId);let addressId=(++cov_rlwj31ydm.s[118],req.params.addressId);++cov_rlwj31ydm.s[119];try{let balance=(++cov_rlwj31ydm.s[120],operator.getBalanceForWalletAddress(walletId,addressId));++cov_rlwj31ydm.s[121];res.status(200).send({balance:balance});}catch(ex){++cov_rlwj31ydm.s[122];if(ex instanceof ArgumentError){++cov_rlwj31ydm.b[17][0];++cov_rlwj31ydm.s[123];throw new HTTPError(400,ex.message,{walletId,addressId},ex);}else{++cov_rlwj31ydm.b[17][1];++cov_rlwj31ydm.s[124];throw ex;}}});++cov_rlwj31ydm.s[125];this.app.get('/node/peers',(req,res)=>{++cov_rlwj31ydm.f[19];++cov_rlwj31ydm.s[126];res.status(200).send(node.peers);});++cov_rlwj31ydm.s[127];this.app.post('/node/peers',(req,res)=>{++cov_rlwj31ydm.f[20];let newPeer=(++cov_rlwj31ydm.s[128],node.connectToPeer(req.body));++cov_rlwj31ydm.s[129];res.status(201).send(newPeer);});++cov_rlwj31ydm.s[130];this.app.get('/node/transactions/:transactionId([a-zA-Z0-9]{64})/confirmations',(req,res)=>{++cov_rlwj31ydm.f[21];++cov_rlwj31ydm.s[131];node.getConfirmations(req.params.transactionId).then(confirmations=>{++cov_rlwj31ydm.f[22];++cov_rlwj31ydm.s[132];res.status(200).send({confirmations:confirmations});});});++cov_rlwj31ydm.s[133];this.app.post('/miner/mine',(req,res,next)=>{++cov_rlwj31ydm.f[23];++cov_rlwj31ydm.s[134];miner.mine(req.body.rewardAddress).then(newBlock=>{++cov_rlwj31ydm.f[24];++cov_rlwj31ydm.s[135];newBlock=Block.fromJson(newBlock);++cov_rlwj31ydm.s[136];blockchain.addBlock(newBlock);++cov_rlwj31ydm.s[137];res.status(201).send(newBlock);}).catch(ex=>{++cov_rlwj31ydm.f[25];++cov_rlwj31ydm.s[138];if((++cov_rlwj31ydm.b[19][0],ex instanceof BlockAssertionError)&&(++cov_rlwj31ydm.b[19][1],ex.message.includes('Invalid index'))){++cov_rlwj31ydm.b[18][0];++cov_rlwj31ydm.s[139];next(new HTTPError(409,'A new block were added before we were able to mine one'),null,ex);}else{++cov_rlwj31ydm.b[18][1];++cov_rlwj31ydm.s[140];next(ex);}});});++cov_rlwj31ydm.s[141];this.app.use(function(err,req,res,next){++cov_rlwj31ydm.f[26];++cov_rlwj31ydm.s[142];// eslint-disable-line no-unused-vars
if(err instanceof HTTPError){++cov_rlwj31ydm.b[20][0];++cov_rlwj31ydm.s[143];res.status(err.status);}else{++cov_rlwj31ydm.b[20][1];++cov_rlwj31ydm.s[144];res.status(500);}++cov_rlwj31ydm.s[145];res.send(err.message+(err.cause?(++cov_rlwj31ydm.b[21][0],' - '+err.cause.message):(++cov_rlwj31ydm.b[21][1],'')));});}listen(host,port){++cov_rlwj31ydm.f[27];++cov_rlwj31ydm.s[146];return new Promise((resolve,reject)=>{++cov_rlwj31ydm.f[28];++cov_rlwj31ydm.s[147];this.server=this.app.listen(port,host,err=>{++cov_rlwj31ydm.f[29];++cov_rlwj31ydm.s[148];if(err){++cov_rlwj31ydm.b[22][0];++cov_rlwj31ydm.s[149];reject(err);}else{++cov_rlwj31ydm.b[22][1];}++cov_rlwj31ydm.s[150];console.info(`Listening http on port: ${this.server.address().port}, to access the API documentation go to http://${host}:${this.server.address().port}/api-docs/`);++cov_rlwj31ydm.s[151];resolve(this);});});}}++cov_rlwj31ydm.s[152];module.exports=HttpServer;