var cov_1u8mxm7dpp=function(){var path='/home/andrews/naivecoin/lib/blockchain/block.js',hash='9c3a8753fb582779cb5ff1b258867faa065ffd2f',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/home/andrews/naivecoin/lib/blockchain/block.js',statementMap:{'0':{start:{line:1,column:10},end:{line:1,column:26}},'1':{start:{line:2,column:19},end:{line:2,column:48}},'2':{start:{line:3,column:20},end:{line:3,column:44}},'3':{start:{line:4,column:21},end:{line:4,column:46}},'4':{start:{line:30,column:8},end:{line:30,column:129}},'5':{start:{line:35,column:8},end:{line:35,column:56}},'6':{start:{line:40,column:27},end:{line:56,column:10}},'7':{start:{line:58,column:8},end:{line:58,column:28}},'8':{start:{line:62,column:20},end:{line:62,column:31}},'9':{start:{line:63,column:8},end:{line:69,column:17}},'10':{start:{line:64,column:12},end:{line:68,column:13}},'11':{start:{line:65,column:16},end:{line:65,column:58}},'12':{start:{line:67,column:16},end:{line:67,column:35}},'13':{start:{line:71,column:8},end:{line:71,column:36}},'14':{start:{line:72,column:8},end:{line:72,column:21}},'15':{start:{line:77,column:0},end:{line:77,column:23}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:28,column:4},end:{line:28,column:5}},loc:{start:{line:28,column:13},end:{line:31,column:5}},line:28},'1':{name:'(anonymous_1)',decl:{start:{line:33,column:4},end:{line:33,column:5}},loc:{start:{line:33,column:20},end:{line:36,column:5}},line:33},'2':{name:'(anonymous_2)',decl:{start:{line:38,column:4},end:{line:38,column:5}},loc:{start:{line:38,column:25},end:{line:59,column:5}},line:38},'3':{name:'(anonymous_3)',decl:{start:{line:61,column:4},end:{line:61,column:5}},loc:{start:{line:61,column:26},end:{line:73,column:5}},line:61},'4':{name:'(anonymous_4)',decl:{start:{line:63,column:28},end:{line:63,column:29}},loc:{start:{line:63,column:44},end:{line:69,column:9}},line:63}},branchMap:{'0':{loc:{start:{line:64,column:12},end:{line:68,column:13}},type:'if',locations:[{start:{line:64,column:12},end:{line:68,column:13}},{start:{line:64,column:12},end:{line:68,column:13}}],line:64},'1':{loc:{start:{line:64,column:16},end:{line:64,column:46}},type:'binary-expr',locations:[{start:{line:64,column:16},end:{line:64,column:37}},{start:{line:64,column:41},end:{line:64,column:46}}],line:64}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0},b:{'0':[0,0],'1':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const R=(++cov_1u8mxm7dpp.s[0],require('ramda'));const CryptoUtil=(++cov_1u8mxm7dpp.s[1],require('../util/cryptoUtil'));const Transaction=(++cov_1u8mxm7dpp.s[2],require('./transaction'));const Transactions=(++cov_1u8mxm7dpp.s[3],require('./transactions'));/*
{ // Block
    "index": 0, // (first block: 0)
    "previousHash": "0", // (hash of previous block, first block is 0) (64 bytes)
    "timestamp": 1465154705, // number of seconds since January 1, 1970
    "nonce": 0, // nonce used to identify the proof-of-work step.
    "transactions": [ // list of transactions inside the block
        { // transaction 0
            "id": "63ec3ac02f...8d5ebc6dba", // random id (64 bytes)
            "hash": "563b8aa350...3eecfbd26b", // hash taken from the contents of the transaction: sha256 (id + data) (64 bytes)
            "type": "regular", // transaction type (regular, fee, reward)
            "data": {
                "inputs": [], // list of input transactions
                "outputs": [] // list of output transactions
            }
        }
    ],
    "hash": "c4e0b8df46...199754d1ed" // hash taken from the contents of the block: sha256 (index + previousHash + timestamp + nonce + transactions) (64 bytes)
}
*/class Block{toHash(){++cov_1u8mxm7dpp.f[0];++cov_1u8mxm7dpp.s[4];// INFO: Usually there are different implementations of the hash algorithm, for example: https://en.bitcoin.it/wiki/Hashcash
return CryptoUtil.hash(this.index+this.previousHash+this.timestamp+JSON.stringify(this.transactions)+this.nonce);}getDifficulty(){++cov_1u8mxm7dpp.f[1];++cov_1u8mxm7dpp.s[5];// 14 is the maximum precision length supported by javascript
return parseInt(this.hash.substring(0,14),16);}static get genesis(){++cov_1u8mxm7dpp.f[2];// The genesis block is fixed
let genesisBlock=(++cov_1u8mxm7dpp.s[6],Block.fromJson({index:0,previousHash:'0',timestamp:1465154705,nonce:0,transactions:[Transaction.fromJson({id:'63ec3ac02f822450039df13ddf7c3c0f19bab4acd4dc928c62fcd78d5ebc6dba',hash:null,type:'regular',data:{inputs:[],outputs:[]}})]}));++cov_1u8mxm7dpp.s[7];return genesisBlock;}static fromJson(data){++cov_1u8mxm7dpp.f[3];let block=(++cov_1u8mxm7dpp.s[8],new Block());++cov_1u8mxm7dpp.s[9];R.forEachObjIndexed((value,key)=>{++cov_1u8mxm7dpp.f[4];++cov_1u8mxm7dpp.s[10];if((++cov_1u8mxm7dpp.b[1][0],key=='transactions')&&(++cov_1u8mxm7dpp.b[1][1],value)){++cov_1u8mxm7dpp.b[0][0];++cov_1u8mxm7dpp.s[11];block[key]=Transactions.fromJson(value);}else{++cov_1u8mxm7dpp.b[0][1];++cov_1u8mxm7dpp.s[12];block[key]=value;}},data);++cov_1u8mxm7dpp.s[13];block.hash=block.toHash();++cov_1u8mxm7dpp.s[14];return block;}}++cov_1u8mxm7dpp.s[15];module.exports=Block;